<!DOCTYPE html>
<html lang="ja">
  <head>
    <link rel="stylesheet" href="SlideShow.css" />
    <title>サンプル</title>
    <script
      src="https://unpkg.com/react@16/umd/react.development.js"
      crossorigin
    ></script>
    <script
      src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"
      crossorigin
    ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.19.0/babel.min.js"></script>

    <script type="text/javascript">
      let k = 0;
      let t = null;

      const stat = () => {
        t = t || window.setInterval(tick, 1000);
      };

      const stop = () => {
        window.clearInterval(t);
        t = null;
      };

      const tick = () => {
        k = (k + 1) % 15;
        document.getElementById("bigimage").setAttribute("src", `pic${k}.jpg`);
      };
    </script>
  </head>

  <body>
    <div id="root"></div>
  </body>

  <script type="text/babel">
    const IMAGE_LENGTH = 15; // 画像の個数
    const SLIDE_SPEED = 1000; // スライドショーの速度
    const getPic = index => `pic${index}.jpg`; // 数字からファイル名を返す

    ReactDOM.render(
      React.createElement(() => {
        const [index, setIndex] = React.useState(0); // 選択中の画像の番号
        const [isActive, setIsActive] = React.useState(false); // タイマーを動かすかどうか

        const toggle = flag => event => setIsActive(flag);
        const doSetIndex = index => event => setIndex(index);

        // 画像を IMAGE_LENGTH 回表示
        const mapImages = [...Array(IMAGE_LENGTH).keys()].map(index => (
          <img
            key={index}
            className="smallimage"
            src={getPic(index)}
            onClick={doSetIndex(index)}
          />
        ));

        // タイマー処理
        React.useEffect(() => {
          let interval = null;
          isActive
            ? (interval = setInterval(
                doSetIndex((index + 1) % IMAGE_LENGTH),
                SLIDE_SPEED
              ))
            : clearInterval(interval);
          return () => clearInterval(interval);
        }, [isActive, index]);

        return (
          <React.Fragment>
            <div id="slideshow">
              <img id="bigimage" src={getPic(index)} />
            </div>

            <div id="navigation">
              <input type="button" value="●" onClick={toggle(true)} />
              <input type="button" value="■" onClick={toggle(false)} />
            </div>

            <div id="thumbnail">{mapImages}</div>
          </React.Fragment>
        );
      }, null),
      document.getElementById("root")
    );
  </script>
</html>
